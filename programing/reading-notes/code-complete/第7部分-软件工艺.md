# 第7部分 软件工艺

## 第31章 布局与风格

### 31.1 基本原则

好的布局凸现程序的逻辑结构

良好布局的目标：

* 准确表现代码的逻辑结构
* 始终如一地表现代码的逻辑结构
* 改善可读性
* 经得起修改

### 31.2 布局技术

* 空白
  * 分组
  * 空行
  * 缩进
* 括号

### 31.3 布局风格

* 纯块结构
* 模仿纯块结构
* 使用begin-end对（花括号）指定块边界
* 行尾布局

### 31.4 控制结构的布局

格式化控制结构块的要点

* 不要用未缩进的begin-end对
* 别让begin和end两次缩进

其他考虑

* 段落之间要使用空行
* 单语句代码块的格式要前后统一
* 对于复杂的表达式，将条件分隔放在几行上
* 不用goto
* case语句不要有行尾布局的例外

### 31.5 单条语句的布局

* 语句长度需要有所限制
* 用空格使语句显得清楚
  * 使用空格会让逻辑表达式更易读
  * 使用空格会让数组引用更容易读
  * 受用空格让子程序参数更容易读
* 格式化后续行
  * 使续行明显
  * 把紧密关联的元素放在一起
  * 将子程序调用的后续行按标准量缩进
  * 使后续行的结尾易于发现
  * 将控制语句后续行缩进以标准的空格数
  * 不要将赋值语句按等号对齐
  * 对赋值语句后续行按标准量对齐
* 每行仅写一条语句
* 数据声明的布局
  * 每行只声明一个数据
  * 变量声明应尽量接近其首次使用的位置
  * 合理组织声明顺序
  * C++中，声明指针变量是请把星号靠近变量名，或者是去声明指针类型

### 31.6 注释的布局

* 注释的缩进要与相应代码一致
* 每行注释用至少一个空行分开

### 31.7 子程序的布局

* 用空行分隔子程序的各部分
* 将子程序参数按标准缩进

### 31.8 类的布局

* 类接口的布局
  * 说明类及其完整用法的头部注释
  * 构造函数和析构函数
  * public子程序
  * protected子程序
  * private子程序和数据成员
* 类实现的布局
  * 描述类所在文件之内容的头部注释
  * 类数据
  * public子程序
  * protected子程序
  * private子程序
* 如果文件包含多个类，要清楚地标出每一个类
* 文件和程序布局
  * 一个文件应只有一个类
  * 文件的命名应与类名相关
  * 在文件中清晰地风格子程序
  * 按字母顺序排列子程序

## 第32章 自说明代码

### 32.1 外部文档

* 单元开发文件夹
* 详细设计文档

### 32.2 编程风格作文档

在代码层文档中其主要作用地因素并非注释，而是好的编程风格

### 32.3 注释或不注释

### 32.4 高效注释之关键

注释种类

* 重复代码：不要写这种注释
* 解释代码：考虑是不是代码写得不清楚
* 代码标记：如TODO标记
* 概述代码
* 代码意图说明
* 传达代码无法表达的信息

高效注释

* 采用不会打断或抑制修改的注释风格
* 用伪代码编程法减少注释时间
* 将注释集成到你的开发风格中
* 性能不是逃避注释的好借口

最佳注释量：约每十条语句有一个注释？

### 32.5 注释技术

* 注释单行
  * 不要随意添加无关注释
  * 不要对单行代码做行尾注释
  * 不要对多样代码做行尾注释
  * 行尾注释用于数据声明
  * 避免用行尾注释存放维护注记
  * 用行尾注释编辑块尾
* 注释代码段
  * 注释应表达代码的意图
  * 代码本身应尽力做好说明
  * 注释代码时应注重why而不是how
  * 用注释未后面的内容做铺垫
  * 让每个注释都有用
  * 说明非常规做法
  * 别用缩略语
  * 将主次注释区分开
  * 错误或语言环境独特点都要加注释
  * 给出违背良好编程风格的理由
  * 不要注释投机取巧的代码，应重写之
* 注释数据声明
  * 注释数值单位
  * 对数值的允许范围给出注释
  * 注释编码含义
  * 注释对输入数据的限制
  * 注释“位标志”
  * 将于变量相关的注释通过变量名关联起来
  * 注释全局数据
* 注释控制解构
  * 应在if，case、循环或者代码段前加上注释
  * 应在每个控制结构后加上注释
  * 将循环结束处的注释看成是代码太复杂的征兆
* 注释子程序
  * 注释应靠近其说明的代码
  * 在子程序上部用一两句话说明之
  * 在声明参数处注释这些参数
  * 利用诸如javadoc之类的代码说明工具
  * 分清输入和输出参数
  * 注释接口假设
  * 对子程序的局限性作注释
  * 说明子程序的全局效果
  * 记录所用算法的来源
  * 用注释标记程序的各部分
* 注释类、文件和程序
  * 说明该类的设计方法
  * 说明局限性、用法假设等
  * 注释类接口
  * 不要在类接口处说明实现细节
  * 说明各文件的意图和内容
  * 将文件命名为与其内容相关的名字
* 程序注释以书本为范例

### 32.6 IEEE标准

## 第33章 个人性格

### 33.1 个人是否和本书话题无关

### 33.2 聪明和谦虚

### 33.3 求知欲

* 在开发过程中建立自我意识
* 试验
* 阅读解决问题的有关方法
* 在行动之前作分析和计划
* 学习成功项目的开发经验
* 阅读文档
* 阅读其他书本期刊
* 同专业人士交往
* 向专业开发看齐

### 33.4 诚实

### 33.5 交流与合作

### 33.6 创造力和纪律

### 33.7 懒惰

### 33.8 不如你想象中那样起作用的性格因素

* 坚持
* 经验
* 编程狂人

### 33.9 习惯

## 第34章 软件工艺的话题

### 34.1 征服复杂性

### 34.2 精选开发过程

### 34.3 首先为人写程序，其次才是为机器

### 34.4 Program into Your Language， Not in it

### 34.5 借助规范集中注意力

### 34.6 基于问题域编程

### 34.7 当心落石

### 34.8 迭代，反反复复，一次又一次

### 34.9 汝当分离软件于信仰

## 第35章 何处有更多信息
